<!-- Snippet de modo oscuro (inline): prevenci√≥n flash, variables CSS y toggle JS -->
<script>
(function(){
    try{
        const t = localStorage.getItem('theme');
        if(t === 'dark') document.documentElement.setAttribute('data-theme','dark');
    }catch(e){ }
})();
</script>

<style>
    :root{
        --bg: #ffffff;
        --text: #111827;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #2563eb;
    }
    html[data-theme="dark"]{
        --bg: #071126;
        --text: #e6eef8;
        --card: #071126;
        --muted: #9ca3af;
        --accent: #60a5fa;
    }
    body, html{background:var(--bg);color:var(--text)}
    .theme-toggle{position:fixed;right:18px;bottom:18px;z-index:9999;background:var(--card);color:var(--text);border:1px solid rgba(0,0,0,0.08);padding:10px 12px;border-radius:999px;cursor:pointer;box-shadow:0 6px 18px rgba(2,6,23,0.12);font-size:16px}
</style>

<!-- Bot√≥n toggle (puedes moverlo dentro del body donde prefieras) -->
<button id="themeToggle" class="theme-toggle" aria-label="Alternar tema">üåì</button>

<script>
(function(){
    function updateIcon(btn, dark){
        if(!btn) return;
        // Usa sol para theme claro y luna para oscuro
        try{
            btn.textContent = dark ? 'üåô' : '‚òÄÔ∏è';
            btn.setAttribute('aria-pressed', dark ? 'true' : 'false');
        }catch(e){}
    }

    function setTheme(dark){
        try{ localStorage.setItem('theme', dark? 'dark' : 'light'); }catch(e){}
        if(dark) document.documentElement.setAttribute('data-theme','dark'); else document.documentElement.removeAttribute('data-theme');
        updateIcon(document.getElementById('themeToggle'), dark);
    }

    try{
        const t = localStorage.getItem('theme');
        const initialDark = t === 'dark';
        if(initialDark) document.documentElement.setAttribute('data-theme','dark');
    }catch(e){}

    // Delay to allow the button added in templates to exist
    function init(){
        const btn = document.getElementById('themeToggle');
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        if(btn) updateIcon(btn, isDark);
        if(btn){
            btn.addEventListener('click', function(){
                const currentlyDark = document.documentElement.getAttribute('data-theme') === 'dark';
                setTheme(!currentlyDark);
            });
        }
    }

    if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init); else init();
})();
</script>
